<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¢¦å¢ƒæœç´¢</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style_add.css">
    <script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>
    <style>
        /* åˆ é™¤è¯­éŸ³è¯†åˆ«ç›¸å…³æ ·å¼ï¼Œå·²ç»ç§»åŠ¨åˆ°style_add.css */
    </style>
</head>
<body>
    <!-- æ–°å¢çš„ç›®å½•ä»‹ç»éƒ¨åˆ† -->
    <div id="catalog-container">
        <!-- ç¬¬1é¡µ -->
        <div class="catalog-page" id="catalog-page-1">
            <img src="images/content/bg.png" alt="èƒŒæ™¯" class="catalog-bg">
            <img src="images/content/element1.png" alt="å…ƒç´ 1" class="catalog-element">
            <img src="images/content/word1.png" alt="æ–‡å­—1" class="catalog-word">
        </div>
        <!-- ç¬¬2é¡µ -->
        <div class="catalog-page" id="catalog-page-2">
            <img src="images/content/bg.png" alt="èƒŒæ™¯" class="catalog-bg">
            <img src="images/content/element2.png" alt="å…ƒç´ 2" class="catalog-element">
            <img src="images/content/word2.png" alt="æ–‡å­—2" class="catalog-word">
        </div>
        <!-- ç¬¬3é¡µ -->
        <div class="catalog-page" id="catalog-page-3">
            <img src="images/content/bg.png" alt="èƒŒæ™¯" class="catalog-bg">
            <img src="images/content/element3.png" alt="å…ƒç´ 3" class="catalog-element">
            <img src="images/content/word3.png" alt="æ–‡å­—3" class="catalog-word">
        </div>
        <!-- ç¬¬4é¡µ -->
        <div class="catalog-page" id="catalog-page-4">
            <img src="images/content/bg.png" alt="èƒŒæ™¯" class="catalog-bg">
            <img src="images/content/element4.png" alt="å…ƒç´ 4" class="catalog-element">
            <img src="images/content/word4.png" alt="æ–‡å­—4" class="catalog-word">
        </div>
        <!-- ç¬¬5é¡µ (ç»“å°¾é¡µ) -->
        <div class="catalog-page" id="catalog-page-5">
            <img src="images/content/bg.png" alt="èƒŒæ™¯" class="catalog-bg">
            <img src="images/content/end.png" alt="ç»“å°¾æ–‡å­—" class="catalog-end-word">
        </div>
    </div>

    <audio id="background-music" loop>
        <source src="audio/bg.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
    </audio>
    <audio id="unlock-sound">
        <source src="audio/unlock.mp3" type="audio/mpeg">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘å…ƒç´ ã€‚
    </audio>
    <script>
        // è‡ªåŠ¨æ’­æ”¾éŸ³é¢‘å¹¶ç¡®ä¿æœ‰å£°éŸ³ï¼ˆä¸é™éŸ³ï¼‰
        window.addEventListener('DOMContentLoaded', function() {
            var audio = document.getElementById('background-music');
            // å–æ¶ˆé™éŸ³
            audio.muted = false;
            // å¤„ç†è‡ªåŠ¨æ’­æ”¾ç­–ç•¥
            var playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.catch(function(error) {
                    // ç”¨æˆ·æœªä¸é¡µé¢äº¤äº’æ—¶ï¼Œè‡ªåŠ¨æ’­æ”¾å¯èƒ½ä¼šå¤±è´¥
                    // å¯ä»¥åœ¨ç”¨æˆ·ç‚¹å‡»ä»»æ„åœ°æ–¹æ—¶å†æ¬¡å°è¯•æ’­æ”¾
                    document.body.addEventListener('click', function tryPlayOnce() {
                        audio.play();
                        document.body.removeEventListener('click', tryPlayOnce);
                    });
                });
            }
        });
    </script>

    <!-- åŸæœ‰çš„å¼€åœºåŠ¨ç”»éƒ¨åˆ† - æ·»åŠ  hidden ç±» -->
    <div id="intro-container" class="intro-active hidden">
        <!-- ä¹¦æœ¬ç¿»é¡µç»„ä»¶ -->
        <div id="book-container">
            <div class="book">
                <div id="cover" class="page-wrapper">
                    <div class="page">
                        <div class="front-cover">
                            <img id="cover-image" src="images/opener/lock_cover.png" alt="é”å®šå°é¢">
                        </div>
                        <div class="back-cover">
                            <img src="images/opener/introduction_left.png" alt="å¼•è¨€é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <!-- è¯­éŸ³è§£é”è¦†ç›–å±‚ (ç§»åŠ¨åˆ° book å¤–é¢, intro-container é‡Œé¢) -->
                <!-- <div id="voice-unlock-overlay" class="voice-unlock-overlay"> ... </div> -->
                <div id="introduction" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/introduction_right.png" alt="å¼•è¨€é¡µå³ä¾§">
                        </div>
                        <div class="page-back">
                            <img src="images/opener/1_left.jpg" alt="ç¬¬1é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <div id="page1" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/1_right.jpg" alt="ç¬¬1é¡µå³ä¾§">
                            <!-- æ¸¸æˆ1æŒ‰é’®å®¹å™¨ -->
                            <div class="game-button-container">
                                <a id="game1-link" href="game1.html" target="_blank" onclick="event.stopPropagation(); return true;" class="bouncing-button">
                                    <span>âœ¨</span>å°å¥³å­©çš„æˆ¿é—´<span>âœ¨</span>
                                </a>
                                <div class="enter-hint">æŒ‰Enteré”®è¿›å…¥å…³å¡</div>
                            </div>
                        </div>
                        <div class="page-back">
                            <img src="images/opener/2_left.jpg" alt="ç¬¬2é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <div id="page2" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/2_right.jpg" alt="ç¬¬2é¡µå³ä¾§">
                            <!-- æ¸¸æˆ2æŒ‰é’®å®¹å™¨ -->
                            <div class="game-button-container">
                                <a id="game2-link" href="game2.html" target="_blank" onclick="event.stopPropagation(); return true;" class="bouncing-button">
                                    <span>ğŸŒ¸</span>æ¨±èŠ±çš„ä¸–ç•Œ<span>ğŸŒ¸</span>
                                </a>
                                <div class="enter-hint">æŒ‰Enteré”®è¿›å…¥å…³å¡</div>
                            </div>
                        </div>
                        <div class="page-back">
                            <img src="images/opener/3_left.jpg" alt="ç¬¬3é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <div id="page3" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/3_right.jpg" alt="ç¬¬3é¡µå³ä¾§">
                            <!-- æ¸¸æˆ3æŒ‰é’®å®¹å™¨ -->
                            <div class="game-button-container">
                                <a id="game3-link" href="game3.html" target="_blank" onclick="event.stopPropagation(); return true;" class="bouncing-button">
                                    <span>ğŸ¬</span>ç³–æœçš„å¤©åœ°<span>ğŸ¬</span>
                                </a>
                                <div class="enter-hint">æŒ‰Enteré”®è¿›å…¥å…³å¡</div>
                            </div>
                        </div>
                        <div class="page-back">
                            <img src="images/opener/4_left.jpg" alt="ç¬¬4é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <div id="page4" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/4_right.jpg" alt="ç¬¬4é¡µå³ä¾§">
                            <!-- æœªå¼€æ”¾å…³å¡æç¤º -->
                            <div class="coming-soon-container">
                                <div class="coming-soon-text">âœ¨ æ¢¦å¢ƒå…³å¡å°šæœªå¼€æ”¾ï¼Œæ•¬è¯·æœŸå¾…ï¼âœ¨</div>
                            </div>
                        </div>
                        <div class="page-back">
                            <img src="images/opener/5_left.jpg" alt="ç¬¬5é¡µå·¦ä¾§">
                        </div>
                    </div>
                </div>
                <div id="page5" class="page-wrapper">
                    <div class="page">
                        <div class="page-front">
                            <img src="images/opener/5_right.jpg" alt="ç¬¬5é¡µå³ä¾§">
                            <!-- æœªå¼€æ”¾å…³å¡æç¤º -->
                            <div class="coming-soon-container">
                                <div class="coming-soon-text">âœ¨ æ¢¦å¢ƒå…³å¡å°šæœªå¼€æ”¾ï¼Œæ•¬è¯·æœŸå¾…ï¼âœ¨</div>
                            </div>
                        </div>
                        <div class="page-back">
                            <img src="images/opener/end.png" alt="å°åº•">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- è¯­éŸ³è§£é”è¦†ç›–å±‚ (ç§»åŠ¨åˆ°è¿™é‡Œ) -->
        <div id="voice-unlock-overlay" class="voice-unlock-overlay">
            <div class="voice-unlock-prompt">è¯·è¯´å‡ºã€Šå“ˆåˆ©æ³¢ç‰¹ã€‹ä¸­çš„è§£é”å’’è¯­ä»¥è§£é”æ¢¦å¢ƒä¹‹ä¹¦</div>
            <div id="listening-indicator" class="listening-indicator">
                <svg width="30" height="30" viewBox="0 0 24 24" fill="white">
                    <path d="M12 15c1.66 0 3-1.34 3-3V6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3zm-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1V6z"/>
                    <path d="M17 12c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V22h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                </svg>
            </div>
            <div id="recognition-result" class="recognition-result">æ­£åœ¨è†å¬...</div>
        </div>
        <div id="intro-overlay">
            <div class="click-hint">ç‚¹å‡»å±å¹•ç»§ç»­</div>
        </div>
    </div>

    <div class="page-scroll-container">
        <!-- ç¬¬ä¸€é¡µ -->
        <section class="page" id="first-page">
            <div class="centered-button">
                <button class="dream-journey-btn">å¼€å¯æ¢¦æ—…</button>
            </div>
        </section>

        <!-- æ–°æ’å…¥çš„ç¬¬äºŒé¡µ -->
        <section class="page sec_page" id="new-second-page">
            <video class="sec-bg-video" src="images/sec_page/bg.mov" autoplay loop muted playsinline></video>
            <div class="sec-content">
                <div class="sec-left">
                    <img src="images/sec_page/slogan.png" alt="slogan" class="sec-img sec-slogan">
                    <img src="images/sec_page/title.png" alt="title" class="sec-img sec-title">
                    <img src="images/sec_page/txt.png" alt="txt" class="sec-img sec-txt">
                </div>
                <div class="sec-right">
                    <img src="images/sec_page/hudie.png" alt="hudie" class="sec-img sec-hudie">
                </div>
            </div>
            <div class="scroll-prompt">
                <div class="prompt-text" style="font-size: 28px;" >æ»‘åŠ¨è§£æ¢¦</div>
                <div class="prompt-arrows">
                    <span style="font-size: 28px;">Ë‡</span>
                    <span style="font-size: 28px;">Ë‡</span>
                    <span style="font-size: 28px;">Ë‡</span>
                </div>
            </div>
        </section>

        <!-- åŸæ¥çš„ç¬¬äºŒé¡µï¼Œç°åœ¨æ˜¯ç¬¬ä¸‰é¡µ -->
        <section class="page trd_page" id="third-page">
            <!-- èƒŒæ™¯è§†é¢‘ -->
            <video class="third-bg-video" src="images/third_page/bg.mov" autoplay loop muted playsinline></video>
            <div class="bubble-bg" id="bubble-bg"></div>
            <!-- ç²¾çµåŠå¯¹è¯æ¡†å’Œç¯å…‰å…ƒç´  -->
            <div class="trd-sprite">
                <img src="images/third_page/spirit.png" class="spirit" alt="spirit">
                <img src="images/third_page/dialog.png" class="dialog" alt="dialog">
                <img src="images/third_page/light.png" class="light" alt="light">
            </div>
            <div class="page-container">


                <!-- Hidden Panels for Hover Effect -->
                <div id="panel-mengzhi" class="hover-panel">
                    <h2>æ¢¦ç»‡ç•Œé¢</h2>
                    <p>è¿™é‡Œæ˜¯æ¢¦ç»‡ç›¸å…³çš„å†…å®¹...</p>
                </div>
                <div id="panel-mengying" class="hover-panel">
                    <h2>æ¢¦å½±ç•Œé¢</h2>
                    <p>è¿™é‡Œæ˜¯æ¢¦å½±ç›¸å…³çš„å†…å®¹...</p>
                </div>
                <div id="panel-mengjie" class="hover-panel">
                    <h2>æ¢¦è§£ç•Œé¢</h2>
                    <p>è¿™é‡Œæ˜¯æ¢¦è§£ç›¸å…³çš„å†…å®¹...</p>
                </div>


                <main>
                    <div class="search-container">
                        <input type="text" id="dream-input" placeholder="è¾“å…¥æ¢¦å¢ƒ">
                        <button class="search-button" id="search-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            </svg>
                        </button>
                    </div>

                    <div id="result-container" class="result-cards-hidden">
                        <div class="result-card" id="card-theme">
                            <h3>æ½œæ„è¯†ä¸»é¢˜</h3>
                            <p></p>
                        </div>
                        <div class="result-card" id="card-emotion">
                            <h3>æƒ…ç»ªåˆ†æ</h3>
                            <p></p>
                        </div>
                        <div class="result-card" id="card-advice">
                            <h3>ç–—æ„ˆå»ºè®®</h3>
                            <p></p>
                        </div>
                    </div>

                </main>

                <div id="bubble-container">
                    <!-- Bubbles will be generated here by JavaScript -->
                </div>
            </div>
        </section>



        <!-- ç¬¬äº”é¡µ -->
        <section class="page fifth-page" id="fifth-page">
            <div class="fifth-flex">
                <div class="fifth-left">
                    <video class="fifth-left-video" autoplay loop muted>
                        <source src="images/fifth_page/left.mov" type="video/mp4">
                    </video>
                    <div class="dream-image-container">
                        <div class="image-loading">
                            <div class="loading-spinner"></div>
                            <p>æ¢¦å¢ƒç”Ÿæˆä¸­...</p>
                            <div class="progress-container" style="width: 80%; background-color: #555; border-radius: 5px; overflow: hidden; margin-top: 10px; height: 10px;">
                              <div class="progress-bar" style="width: 0%; height: 100%; background-color: #74c0fc; transition: width 0.5s ease;"></div>
                            </div>
                            <p class="progress-text" style="margin-top: 5px; font-size: 14px;"></p>
                            <p class="error-count" style="margin-top: 5px; font-size: 12px; color: #ff6b6b;"></p>
                        </div>
                        <div class="generated-image">
                            <img src="" alt="ç”Ÿæˆçš„æ¢¦å¢ƒå›¾åƒ">
                        </div>
                        <div class="info-message" style="display: none;"></div>
                        <div class="error-message" style="display: none;"></div>
                        <button class="check-task-btn" style="display: none;">æŸ¥çœ‹ä»»åŠ¡</button>
                        <button class="debug-btn" style="display: none;">è°ƒè¯•ä¿¡æ¯</button>
                    </div>
                    <div class="dream-image-mask"></div>
                </div>
                <div class="fifth-right">
                    <div class="fifth-right-texts">
                        <img class="fifth-slogan" src="images/fifth_page/slogan.png" alt="Slogan">
                        <img class="fifth-title" src="images/fifth_page/title.png" alt="Title">
                        <img class="fifth-txt" src="images/fifth_page/txt.png" alt="Description">
                    </div>
                    <button class="visual-dream-btn">å¯è§†æ¢¦å¢ƒ</button>
                    <img class="fifth-right-img" src="images/fifth_page/example.png" alt="Example Image">
                </div>
            </div>
            <!-- æ–°å¢çš„å¯è§†åŒ–è¦†ç›–å±‚ -->
            <div id="visualization-overlay">
                <div class="blur-background"></div>
                <video id="load-video" loop muted playsinline>
                    <source src="images/six_page/load.mov" type="video/quicktime">
                    <source src="images/six_page/load.mp4" type="video/mp4">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
                </video>
                <div class="window-container">
                     <img id="window-image" src="images/six_page/window.png" alt="çª—å£">
                     <!-- ç”Ÿå›¾UIå°†ç§»åŠ¨åˆ°è¿™é‡Œ -->
                     <div id="embedded-ui-placeholder"></div>
                </div>
                <button id="close-visualization-btn">&times;</button>
            </div>
        </section>


        <!-- æœ€åé¡µé¢ -->
        <div id="last-page" class="page">
            <div class="background-image">
                <img src="images/end_page/bg.png" alt="åº•å›¾" class="bg-bottom">
                <img src="images/end_page/bg_above.png" alt="ä¸Šå±‚å›¾" class="bg-above">
            </div>
        </div>

    </div>

    <script src="script.js"></script>
    <script src="script_add.js"></script>

    <script>
      // Lenis smooth scrolling
      const lenis = new Lenis()
      function raf(time) { lenis.raf(time); requestAnimationFrame(raf) }
      requestAnimationFrame(raf)

      // Observe sec_page entry/exit to toggle animations
      const pagesToObserve = [
        document.getElementById('new-second-page'),
        document.getElementById('third-page')
      ]
      const io = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const el = entry.target
          if (entry.isIntersecting) el.classList.add('animate')
          else el.classList.remove('animate')
        })
      }, { threshold: 0.5 })
      pagesToObserve.forEach(page => io.observe(page));

      // ç‚¹å‡»è¾“å…¥æ¡†æ—¶éšè—èƒŒæ™¯è§†é¢‘ï¼Œä½¿ç”¨é™æ€èƒŒæ™¯
      const trdPage = document.querySelector('.trd_page');
      const dreamInput = document.getElementById('dream-input');
      dreamInput.addEventListener('focus', () => trdPage.classList.add('no-video'));
      dreamInput.addEventListener('blur', () => trdPage.classList.remove('no-video'));

      document.addEventListener('DOMContentLoaded', function() {
        // è¯­éŸ³è¯†åˆ«ç›¸å…³ä»£ç 
        const listeningIndicator = document.getElementById('listening-indicator');
        const recognitionResult = document.getElementById('recognition-result');
        const voiceUnlockOverlay = document.getElementById('voice-unlock-overlay');
        const coverImage = document.getElementById('cover-image');
        const unlockSound = document.getElementById('unlock-sound');
        const magicPhrase = "é˜¿æ‹‰éœæ´å¼€"; // è§£é”å’’è¯­
        
        // æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯­éŸ³è¯†åˆ«
        if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
            recognitionResult.textContent = "æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½ï¼Œè¯·å°è¯•ä½¿ç”¨Chromeæµè§ˆå™¨ã€‚";
            return;
        }
        
        // åˆ›å»ºè¯­éŸ³è¯†åˆ«å¯¹è±¡
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'zh-CN'; // è®¾ç½®è¯­è¨€ä¸ºä¸­æ–‡
        recognition.interimResults = false; // åªè¿”å›æœ€ç»ˆç»“æœ
        recognition.maxAlternatives = 1; // è¿”å›æœ€å¯èƒ½çš„è¯†åˆ«ç»“æœ
        recognition.continuous = false; // ä¸è¿ç»­è¯†åˆ«ï¼Œæ¯æ¬¡è¯†åˆ«å®Œæˆååœæ­¢
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨å¼€å§‹è¯­éŸ³è¯†åˆ«
        setTimeout(function() {
            startVoiceRecognition();
        }, 500); // å»¶è¿ŸåŠç§’å¯åŠ¨ï¼Œç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
        
        function startVoiceRecognition() {
            recognition.start();
            listeningIndicator.style.display = 'flex';
            recognitionResult.textContent = "æ­£åœ¨è†å¬...";
        }
        
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript.trim();
            recognitionResult.textContent = `æ‚¨è¯´: "${transcript}"`;
            
            // æ£€æŸ¥æ˜¯å¦è¯´å‡ºäº†è§£é”å’’è¯­
            if (transcript.includes(magicPhrase)) {
                // è§£é”æˆåŠŸ
                unlockCover();
            } else {
                // è§£é”å¤±è´¥ï¼Œé‡æ–°å¼€å§‹è¯†åˆ«
                setTimeout(function() {
                    recognitionResult.textContent = "å’’è¯­ä¸æ­£ç¡®ï¼Œè¯·é‡è¯•ã€‚";
                    setTimeout(startVoiceRecognition, 1500);
                }, 1000);
            }
        };
        
        recognition.onerror = function(event) {
            console.log("è¯­éŸ³è¯†åˆ«é”™è¯¯:", event.error);
            // å‡ºé”™åé‡æ–°å¼€å§‹è¯†åˆ«
            if (event.error !== 'aborted') {
                setTimeout(function() {
                    recognitionResult.textContent = "è¯·é‡æ–°è¯´å‡ºå’’è¯­";
                    setTimeout(startVoiceRecognition, 1000);
                }, 1000);
            }
        };
        
        recognition.onend = function() {
            // å¦‚æœä¸æ˜¯å› ä¸ºè¯†åˆ«åˆ°æ­£ç¡®å’’è¯­è€Œç»“æŸçš„ï¼Œå°±è‡ªåŠ¨é‡æ–°å¼€å§‹
            if (voiceUnlockOverlay.style.display !== 'none' && !recognitionResult.textContent.includes("å’’è¯­æ­£ç¡®")) {
                setTimeout(startVoiceRecognition, 300);
            }
        };
        
        function unlockCover() {
            // æ’­æ”¾è§£é”éŸ³æ•ˆ
            unlockSound.play();
            
            // æ›´æ¢å°é¢å›¾ç‰‡ä¸ºè§£é”çŠ¶æ€
            coverImage.src = "images/opener/cover.png";
            coverImage.alt = "å°é¢";
            
            // æ·»åŠ è§£é”æˆåŠŸåŠ¨ç”»ç±»
            voiceUnlockOverlay.classList.add('unlock-success');
            
            // å»¶è¿Ÿç§»é™¤è¯­éŸ³è§£é”è¦†ç›–å±‚ï¼Œç»™åŠ¨ç”»è¶³å¤Ÿçš„æ—¶é—´
            setTimeout(() => {
                voiceUnlockOverlay.style.display = 'none';
            }, 1500);
            
            // æ˜¾ç¤ºè§£é”æˆåŠŸæ¶ˆæ¯
            recognitionResult.textContent = "å’’è¯­æ­£ç¡®ï¼å°é¢å·²è§£é”ã€‚";
        }

        // æ·»åŠ é”®ç›˜ç›‘å¬ï¼Œå¤„ç†Enteré”®è¿›å…¥æ¸¸æˆ
        let currentActivePage = null;
        const pages = document.querySelectorAll('.page-wrapper');
        
        // è·å–å½“å‰æ´»åŠ¨é¡µé¢
        function updateActivePage() {
          pages.forEach((page, index) => {
            const rect = page.getBoundingClientRect();
            const isVisible = rect.left >= 0 && rect.left < window.innerWidth / 2;
            if (isVisible) {
              currentActivePage = index;
            }
          });
        }
        
        // åˆå§‹æ›´æ–°æ´»åŠ¨é¡µ
        setTimeout(updateActivePage, 1000);
        
        // åœ¨ç¿»é¡µæ—¶æ›´æ–°æ´»åŠ¨é¡µ
        document.addEventListener('click', function() {
          setTimeout(updateActivePage, 500); // å»¶è¿Ÿæ›´æ–°ï¼Œç­‰å¾…ç¿»é¡µåŠ¨ç”»
        });
        
        // å¤„ç†Enteré”®è¿›å…¥æ¸¸æˆ
        document.addEventListener('keydown', function(event) {
          if (event.key === 'Enter' && currentActivePage !== null) {
            switch(currentActivePage) {
              case 1: // å°å¥³å­©çš„æˆ¿é—´é¡µï¼ˆpage1ï¼‰
                localStorage.setItem('gameCompleted', 'game1');  // æ ‡è®°æ­£åœ¨ç©game1
                window.open('game1.html', '_blank'); // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                break;
              case 2: // æ¨±èŠ±ä¸–ç•Œé¡µï¼ˆpage2ï¼‰
                localStorage.setItem('gameCompleted', 'game2');  // æ ‡è®°æ­£åœ¨ç©game2
                window.open('game2.html', '_blank'); // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                break;
              case 3: // ç³–æœå¤©åœ°é¡µï¼ˆpage3ï¼‰
                localStorage.setItem('gameCompleted', 'game3');  // æ ‡è®°æ­£åœ¨ç©game3
                window.open('game3.html', '_blank'); // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                break;
            }
          }
        });
        
        // æ£€æŸ¥æ˜¯å¦ä»æ¸¸æˆé€šå…³åè¿”å›
        window.addEventListener('load', function() {
          const gameCompleted = localStorage.getItem('gameCompleted');
          if (gameCompleted) {
            // ç§»é™¤å­˜å‚¨çš„æ¸¸æˆçŠ¶æ€
            localStorage.removeItem('gameCompleted');
            
            // æ ¹æ®å®Œæˆçš„æ¸¸æˆï¼Œè‡ªåŠ¨è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ¸¸æˆ
            setTimeout(() => {
              const bookContainer = document.getElementById('book-container');
              if (bookContainer) {
                switch(gameCompleted) {
                  case 'game1':
                    // è·³è½¬åˆ°æ¨±èŠ±ä¸–ç•Œé¡µé¢
                    turnToPage('page2');
                    break;
                  case 'game2':
                    // è·³è½¬åˆ°ç³–æœå¤©åœ°é¡µé¢
                    turnToPage('page3');
                    break;
                  case 'game3':
                    // æœ€åä¸€ä¸ªæ¸¸æˆé€šå…³åå¯ä»¥è·³è½¬åˆ°ç»“å°¾é¡µæˆ–å…¶ä»–é¡µé¢
                    turnToPage('page4');
                    break;
                }
              }
            }, 1500); // å»¶è¿Ÿç¿»é¡µï¼Œç­‰å¾…åŠ¨ç”»å®Œæˆ
            
            return; // å¦‚æœæ˜¯æ¸¸æˆé€šå…³è¿”å›ï¼Œä¸éœ€è¦æ‰§è¡Œåé¢çš„returnToPageé€»è¾‘
          }
          
          // åŸæœ‰çš„returnToPageé€»è¾‘ä¿ç•™ï¼Œä»¥é˜²éœ€è¦ - è¿™éƒ¨åˆ†ç°åœ¨ä¸å†éœ€è¦ï¼Œå› ä¸ºreturnToBookPageä¸å†è¢«è®¾ç½®
          /*
          const returnToPage = localStorage.getItem('returnToBookPage');
          if (returnToPage) {
            // å…ˆç§»é™¤å­˜å‚¨çš„è¿”å›é¡µé¢ä¿¡æ¯
            localStorage.removeItem('returnToBookPage');
            
            // ç­‰å¾…ä¹¦æœ¬åŠ è½½å®Œæˆåç¿»åˆ°å¯¹åº”é¡µé¢
            setTimeout(() => {
              const bookContainer = document.getElementById('book-container');
              if (bookContainer) {
                switch(returnToPage) {
                  case 'page1':
                    // ç¿»åˆ°å°å¥³å­©çš„æˆ¿é—´é¡µ
                    turnToPage('page1');
                    break;
                  case 'page2':
                    // ç¿»åˆ°æ¨±èŠ±ä¸–ç•Œé¡µ
                    turnToPage('page2');
                    break;
                  case 'page3':
                    // ç¿»åˆ°ç³–æœå¤©åœ°é¡µ
                    turnToPage('page3');
                    break;
                }
              }
            }, 1500); // å»¶è¿Ÿç¿»é¡µï¼Œç­‰å¾…åŠ¨ç”»å®Œæˆ
          }
          */
        });
        
        // ç¿»é¡µåˆ°æŒ‡å®šé¡µé¢çš„è¾…åŠ©å‡½æ•°
        function turnToPage(targetPageId) {
          // æ¨¡æ‹Ÿç‚¹å‡»ï¼Œè§¦å‘ç¿»é¡µæ•ˆæœ
          let foundTarget = false;
          let currentPage = document.getElementById('cover');
          
          // ä»å°é¢å¼€å§‹ï¼Œä¸€é¡µä¸€é¡µç¿»ï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡é¡µ
          while (currentPage && currentPage.id !== targetPageId) {
            // æ¨¡æ‹Ÿç‚¹å‡»ç¿»é¡µ
            currentPage.click();
            
            // è·å–ä¸‹ä¸€é¡µ
            const index = Array.from(pages).indexOf(currentPage);
            if (index < pages.length - 1) {
              currentPage = pages[index + 1];
            } else {
              break;
            }
            
            // é˜²æ­¢æ— é™å¾ªç¯
            if (currentPage.id === targetPageId) {
              foundTarget = true;
              break;
            }
          }
        }
      });
    </script>

    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>
    <script src="js/jquery.booklet.latest.min.js"></script>
    <script src="js/book_config.js"></script>
    <script src="js/main.js"></script>
    <script src="js/share.js"></script>

    <!-- æ–°å¢ç›®å½•ä»‹ç»äº¤äº’é€»è¾‘ -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const catalogContainer = document.getElementById('catalog-container');
            const catalogPages = document.querySelectorAll('.catalog-page');
            const introContainer = document.getElementById('intro-container');
            let currentPageIndex = 0;

            // åˆå§‹æ˜¾ç¤ºç¬¬ä¸€é¡µ
            if (catalogPages.length > 0) {
                catalogPages[currentPageIndex].classList.add('active');
            }

            catalogContainer.addEventListener('click', () => {
                const currentPage = catalogPages[currentPageIndex];
                if (!currentPage) return;

                const element = currentPage.querySelector('.catalog-element');
                const word = currentPage.querySelector('.catalog-word');
                const endWord = currentPage.querySelector('.catalog-end-word');

                // æ¸éšå½“å‰é¡µçš„å…ƒç´ å’Œæ–‡å­— (å¦‚æœå­˜åœ¨)
                if (element) {
                    element.classList.add('fade-out');
                }
                if (word) {
                    word.classList.add('fade-out');
                }
                 // å¦‚æœæ˜¯æœ€åä¸€é¡µï¼Œä¹Ÿæ¸éšç»“æŸæ–‡å­—
                if (currentPageIndex === catalogPages.length - 1 && endWord) {
                     endWord.classList.add('fade-out');
                }

                // å»¶è¿Ÿåˆ‡æ¢é¡µé¢ï¼Œè®©æ¸éšåŠ¨ç”»æ’­æ”¾
                setTimeout(() => {
                    // éšè—å½“å‰é¡µ
                    currentPage.classList.remove('active');

                    // ç§»åŠ¨åˆ°ä¸‹ä¸€é¡µæˆ–ç»“æŸ
                    currentPageIndex++;

                    if (currentPageIndex < catalogPages.length) {
                        // æ˜¾ç¤ºä¸‹ä¸€é¡µ
                        catalogPages[currentPageIndex].classList.add('active');
                        // æ–°é¡µé¢çš„å…ƒç´ å’Œæ–‡å­—æ¢å¤ä¸é€æ˜ (å¦‚æœä¹‹å‰è¢«éšè—è¿‡)
                        const nextElement = catalogPages[currentPageIndex].querySelector('.catalog-element');
                        const nextWord = catalogPages[currentPageIndex].querySelector('.catalog-word');
                        if (nextElement) nextElement.classList.remove('fade-out');
                        if (nextWord) nextWord.classList.remove('fade-out');
                    } else {
                        // æ‰€æœ‰ç›®å½•é¡µç»“æŸï¼Œéšè—ç›®å½•å®¹å™¨ï¼Œæ˜¾ç¤ºä¹¦æœ¬
                        catalogContainer.classList.add('hidden');
                        introContainer.classList.remove('hidden');
                        // æ­¤å¤„å¯ä»¥è§¦å‘ä¹¦æœ¬çš„åˆå§‹åŒ–æˆ–è‡ªåŠ¨ç¿»é¡µç­‰ (å¦‚æœéœ€è¦)
                        // ä¾‹å¦‚: $('#mybook').booklet("next");
                    }
                }, 500); // å»¶è¿Ÿæ—¶é—´åº”ç•¥å°äºæˆ–ç­‰äºCSSä¸­çš„è¿‡æ¸¡æ—¶é—´
            });
        });
    </script>
    <!-- ç›®å½•ä»‹ç»äº¤äº’é€»è¾‘ç»“æŸ -->

</body>
</html>